<div class="container my-2">
  <div class="d-flex justify-content-center my-3">
    <h1>Listado de Roles de Usuario</h1>
  </div>

  <!-- Aviso (mensaje desde queryParams) -->
  @if (message()) {
    <div class="d-flex justify-content-center my-2">
      <div class="alert alert-success w-100 text-center" role="alert">
        {{ message() }}
      </div>
    </div>
  }

  <!-- Búsqueda por descripción usando debounce -->
  <div class="d-flex justify-content-center my-2">
    <div class="w-100">
      <label for="rolusuario-search" class="form-label visually-hidden">Buscar por descripción</label>
      <input
        id="rolusuario-search"
        class="form-control"
        type="search"
        placeholder="Buscar por descripción"
        aria-label="Buscar por descripción"
        (input)="onSearchDescription($event.target.value)"
        [value]="descripcion()"
        name="searchDescription"
      />
    </div>
  </div>

  <!-- Total registros -->
  <div class="d-flex justify-content-center my-1">
    <small class="text-muted">Total registros: {{ totalRecords() || 0 }}</small>
  </div>

  <!-- Ocultar paginación y RPP si no hay registros -->
  @if (totalRecords() > 0) {
    <div class="d-flex justify-content-between my-1">
      <app-paginacion
        [numPage]="numPage()"
        [numPages]="oPage()?.totalPages || 1"
        (pageChange)="goToPage($event)"
      >
      </app-paginacion>

      <app-botonera-rpp
        [numRpp]="numRpp()"
        (rppChange)="onRppChange($event)">
      </app-botonera-rpp>
    </div>
  }

  @if (totalRecords() > 0) {
    <div class="d-flex justify-content-center">
      <table class="table table-striped table-bordered">
        <thead>
          <tr>
            <th scope="col" (click)="onOrder('id')" style="cursor: pointer; width: 10%">
              <span class="header-inline">
                ID
                @if (orderField() === 'id') {
                  @if (orderDirection() === 'asc') {
                    <i class="bi bi-caret-up-fill ms-1" aria-hidden="true"></i>
                  }
                  @if (orderDirection() === 'desc') {
                    <i class="bi bi-caret-down-fill ms-1" aria-hidden="true"></i>
                  }
                }
              </span>
            </th>

            <th scope="col" (click)="onOrder('descripcion')" style="cursor: pointer">
              <span class="header-inline">
                Descripción
                @if (orderField() === 'descripcion') {
                  @if (orderDirection() === 'asc') {
                    <i class="bi bi-caret-up-fill ms-1" aria-hidden="true"></i>
                  }
                  @if (orderDirection() === 'desc') {
                    <i class="bi bi-caret-down-fill ms-1" aria-hidden="true"></i>
                  }
                }
              </span>
            </th>

            <th scope="col" style="width: 15%">
              <span class="header-inline">Usuarios</span>
            </th>
          </tr>
        </thead>

        <tbody>
          @for (rol of oPage()?.content; track rol.id) {
            <tr>
              <td style="text-align: center">{{ rol.id }}</td>
              <td>{{ rol.descripcion }}</td>
              <td class="text-center">{{ rol.usuarios }}</td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }

  @if (totalRecords() === 0) {
    <div class="alert alert-secondary text-center my-4">
      No hay roles de usuario para mostrar.
    </div>
  }
</div>


